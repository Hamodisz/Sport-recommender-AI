import streamlit as st
import openai
import os

# --- ูุงุฌูุฉ ุงุฎุชูุงุฑ ุงููุบุฉ ---
st.set_page_config(page_title="ุชูุตูุฉ ุงูุฑูุงุถุฉ ุงูููุงุณุจุฉ", layout="centered")
st.title("๐ค ูุธุงู ุงูุชูุตูุฉ ุงูุฑูุงุถูุฉ ุงูุฐูู")

language = st.radio("๐ ุงุฎุชุฑ ุงููุบุฉ / Choose Language:", ("ุงูุนุฑุจูุฉ", "English"))

# --- ุฅุฏุฎุงู ููุชุงุญ OpenAI ---
api_key = st.text_input("๐ ุฃุฏุฎู ููุชุงุญ OpenAI ุงูุฎุงุต ุจู / Enter your OpenAI API key", type="password")
if not api_key:
    st.stop()
openai.api_key = api_key

# --- ุชุญุฏูุฏ ุงูุฃุณุฆูุฉ ูุงูุฅุฌุงุจุงุช ุญุณุจ ุงููุบุฉ ---
if language == "ุงูุนุฑุจูุฉ":
    questions = [
        "ููู ุชุจุฏุฃ ูููู ุบุงูุจูุงุ",
        "ูุง ููุน ุงูุฃูุดุทุฉ ุงูุชู ุชุฌุนูู ุชูุณู ุงูููุชุ",
        "ููู ูุงู ุชูุงุนูู ูุน ุงูุญุตุต ุงูุฑูุงุถูุฉ ูู ุงููุฏุฑุณุฉุ",
        "ููู ุชุชุนุงูู ูุน ุงูุถุบุท ุฃู ุงูุชูุชุฑุ",
        "ููู ุชุญุจ ูุถุงุก ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุนุ",
        "ูุง ุฃูุซุฑ ุจูุฆุฉ ุชูุถูู ูููุง ูุถุงุก ููุช ูุฑุงุบูุ",
        "ุฅุฐุง ุทููุจ ููู ุชุฌุฑุจุฉ ุฑูุงุถุฉ ุฌุฏูุฏุฉุ ูุง ุฃูู ูุง ุชููุฑ ูููุ",
        "ูู ุทูููุชูุ ูุง ููุน ุงูุฃูุนุงุจ ุงูุชู ููุช ุชูุถููุงุ",
        "ููู ุชุตู ุนูุงูุชู ูุน ุงููุฎุงุทุฑุฉุ",
        "ูุง ููุน ุงูุฃูุดุทุฉ ุงูุชู ุชุนุทูู ุฅุญุณุงุณ ุจุงูุฅูุฌุงุฒุ",
        "ููู ุชุชุนุงูู ูุน ุงููุดู ุฃู ุงูุฎุณุงุฑุฉุ",
        "ูุง ุงูุฐู ูุฌุฐุจู ูู ุฃู ูุดุงุท ุฌุฏูุฏุ",
        "ูุง ุฃูุซุฑ ุดูุก ููุญููุฒู ููุงุณุชูุฑุงุฑ ูู ููุงุฑุณุฉ ูุดุงุทุ",
        "ุฃู ููุน ูู ุงูุชุนุจูุฑ ููุงุณุจู ุฃูุซุฑุ",
        "ูุง ุฃูุซุฑ ูุง ุชุจุญุซ ุนูู ูู ุฃู ุฑูุงุถุฉ ุฃู ูุดุงุทุ",
        "ุฃู ูู ุงูุชุงูู ุฃูุฑุจ ูููุท ุญูุงุชู ุงูููููุ",
        "ุนูุฏูุง ุชุชุนูู ููุงุฑุฉ ุฌุฏูุฏุฉุ ููู ุชูุถูู ุฐููุ",
        "ุฃู ูุตู ุฃูุฑุจ ูุทุจูุนุชู ุงูููููุฉุ",
        "ูุง ุงูุฐู ูุฌุนูู ุชุชุฑู ููุงุฑุณุฉ ุฑูุงุถุฉ ูุนููุฉุ",
        "ูู ูุงู ุจุฅููุงูู ุชุตููู ุฑูุงุถุฉ ุฎุงุตุฉ ุจูุ ููู ุณุชูููุ"
    ]

    options = [
        ["ุฃ) ุฃุจุฏุฃ ูุจุงุดุฑุฉ ุจูุดุงุท ุฌุณุฏู", "ุจ) ุฃุญุชุงุฌ ุจุนุถ ุงูููุช", "ุฌ) ุฃุฑุชุจ ุฃููุงุฑู", "ุฏ) ูุง ุฑูุชูู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุญุฑูุฉ ูุชุญุฏู", "ุจ) ุชูุงุนู ุฌูุงุนู", "ุฌ) ุฃูุบุงุฒ ุฐูููุฉ", "ุฏ) ุงุณุชุฑุฎุงุก", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ูุชุญูุณ ุฏุงุฆููุง", "ุจ) ุญุณุจ ุงููุดุงุท", "ุฌ) ูุง ุฃุฑุชุงุญ ููุง", "ุฏ) ุฃุชูุฑุจ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฃุชุญุฑู", "ุจ) ุฃุชููู ูุน ุฃุญุฏ", "ุฌ) ุฃูุฑุฃ", "ุฏ) ุฃูุนุฒู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ูุบุงูุฑุงุช", "ุจ) ุงุฌุชูุงุนู", "ุฌ) ุชุฎุทูุท", "ุฏ) ุฑุงุญุฉ ููุฒููุฉ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุทุจูุนุฉ", "ุจ) ุฃูุงูู ูุฒุฏุญูุฉ", "ุฌ) ุจูุช ุฃู ููุชุจ", "ุฏ) ุญุณุจ ุงููุฒุงุฌ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุญูุงุณ ูุชุญุฏู", "ุจ) ูู ูุนูุ", "ุฌ) ูุงุฆุฏุชูุง", "ุฏ) ุฃูุงููุง", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฃูุนุงุจ ุญุฑููุฉ", "ุจ) ุชูุงูุณูุฉ", "ุฌ) ููุฑูุฉ", "ุฏ) ุฎูุงููุฉ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฃุญุจ ุงููุฎุงุทุฑุฉ", "ุจ) ุฃูุงุฒู", "ุฌ) ุญุฐุฑ", "ุฏ) ุฃุชูุฑุจ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฅูุฌุงุฒ ุจุฏูู", "ุจ) ุฅูุฌุงุฒ ุฌูุงุนู", "ุฌ) ุฅูุฌุงุฒ ุฐููู", "ุฏ) ุฏุงุฎูู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฃุนูุฏ ุจููุฉ", "ุจ) ุฃุชููู", "ุฌ) ุฃุฑุงุฌุน ุจูุฏูุก", "ุฏ) ุฃุจุชุนุฏ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุงูุชุญุฏู", "ุจ) ุงูุชูุงุนู", "ุฌ) ุงูููุฑุฉ", "ุฏ) ุงูุจุณุงุทุฉ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุชุทูุฑ ุฌุณุฏู", "ุจ) ุจูุฆุฉ ูุดุฌุนุฉ", "ุฌ) ุดุนูุฑ ุฏุงุฎูู", "ุฏ) ูุง ุฃูู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุฌุณุฏู", "ุจ) ุงุฌุชูุงุนู", "ุฌ) ูุชุงุจู", "ุฏ) ููู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุชุญุฏู ููุชุงุฆุฌ", "ุจ) ูุชุนุฉ ูุชูุงุตู", "ุฌ) ุชุทููุฑ ุฐุงุชู", "ุฏ) ุงุณุชุฑุฎุงุก", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ูุซูุฑ ุญุฑูุฉ", "ุจ) ุชูุงุนู ุงุฌุชูุงุนู", "ุฌ) ููุงู ุฐูููุฉ", "ุฏ) ูุฏูุก", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุจุงูุชุฌุฑุจุฉ", "ุจ) ุงูุชูุงุนู", "ุฌ) ุงูููู ุฃููุงู", "ุฏ) ุงูููุงุญุธุฉ", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุณุฑูุนุ ุญุฑูู", "ุจ) ุงุฌุชูุงุนู", "ุฌ) ุฏููู ูููุงุญุธ", "ุฏ) ูุชุฒู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุจุฏูู ูุชุงุฆุฌ", "ุจ) ูููุฉ", "ุฌ) ุบูุฑ ูููุฏุฉ ุฐููููุง", "ุฏ) ูุง ุชูุงุณุจ ููุชู", "ูู) ูุง ุดูุก ููุง ุณุจู"],
        ["ุฃ) ุชุญุฏู ููุบุงูุฑุฉ", "ุจ) ุชูุงุนู ุงุฌุชูุงุนู", "ุฌ) ุชูููุฑ ูุฐูุงุก", "ุฏ) ูุฏูุก", "ูู) ูุง ุดูุก ููุง ุณุจู"]
    ]
    prompt_intro = "ุฃูุช ุฎุจูุฑ ููุณู ูุฑูุงุถู. ุงูุฑุฃ ุฅุฌุงุจุงุช ูุฐุง ุงูุดุฎุต ูุงูุชุฑุญ ุนููู ุฑูุงุถุฉ ูุงุญุฏุฉ ุชูุงุณุจูุ ูุงุฐูุฑ ุงูุณุจุจุ ุจุงูุนุฑุจูุฉ ููุท."
else:
    questions = [  # โ ุงุฎุชุตุงุฑ ููุฅูุฌููุฒูุฉ ููุง... ูููู ูุงุญููุง ูู ุญุจูุช
        "How do you usually start your day?",
        "What kind of activities make you lose track of time?",
        # ุฃููู ุญุณุจ ุงูุญุงุฌุฉ
    ]
    options = [
        ["A) Physical activity", "B) Need time", "C) Organize thoughts", "D) No routine", "E) None of the above"],
        ["A) Challenge", "B) Socializing", "C) Mental games", "D) Relaxing", "E) None of the above"],
        # ุฃููู ุญุณุจ ุงูุญุงุฌุฉ
    ]
    prompt_intro = "You are a sports and psychology expert. Read this person's answers and recommend one sport that suits them, in English only."

# --- ุฌูุน ุงูุฅุฌุงุจุงุช ---
st.markdown("---")
st.subheader("๐ง ุฌุงูุจ ุนูู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ:" if language == "ุงูุนุฑุจูุฉ" else "๐ง Answer the following questions:")

answers = []
for i in range(len(questions)):
    st.markdown(f"**{i+1}. {questions[i]}**")
    choice = st.radio(f"", options[i], key=f"q{i}")
    if "ูู" in choice or "E)" in choice:
        other = st.text_input("๐ ุงูุชุจ ุฅุฌุงุจุชู:", key=f"text_{i}")
        answers.append(other if other else choice)
    else:
        answers.append(choice)

# --- ุฒุฑ ุงูุชูุตูุฉ ---
if st.button("๐ฏ ุงุญุตู ุนูู ุงูุชูุตูุฉ ุงูุฑูุงุถูุฉ" if language == "ุงูุนุฑุจูุฉ" else "๐ฏ Get Sport Recommendation"):
    full_input = "\n".join([f"{i+1}. {ans}" for i, ans in enumerate(answers)])

    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[
            {"role": "system", "content": prompt_intro},
            {"role": "user", "content": full_input}
        ]
    )

    st.markdown("---")
    st.subheader("โ ุงูุชูุตูุฉ ุงูุฑูุงุถูุฉ:" if language == "ุงูุนุฑุจูุฉ" else "โ Sport Recommendation:")
    st.success(response['choices'][0]['message']['content'])
