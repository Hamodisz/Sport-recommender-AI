# streamlit_app.py

import streamlit as st
from backend import generate_sport_recommendation
from PIL import Image, ImageDraw, ImageFont
import io
import pyperclip

st.set_page_config(page_title="Sport Recommender", layout="centered")

st.title("๐ ุงูุชุดู ุงูุฑูุงุถุฉ ุงูููุงุณุจุฉ ูู")
st.markdown("ุฃุฌุจ ุนูู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ ูุณููุชุฑุญ ูู ุฑูุงุถุฉ ุชูุงุณุจ ุดุฎุตูุชู.")

# ุงุฎุชูุงุฑ ุงููุบุฉ
language = st.selectbox("ุงุฎุชุฑ ุงููุบุฉ", ["ุงูุนุฑุจูุฉ", "English"])
lang_code = "ar" if language == "ุงูุนุฑุจูุฉ" else "en"

# ูููุฐุฌ ุงูุฃุณุฆูุฉ
user_answers = ""
questions = [
    "1. ูู ุณุจู ุฃู ูุงุฑุณุช ุฑูุงุถุฉ ูู ูุจูุ",
    "2. ููู ุชุตู ูุดุงุทู ุฎูุงู ููููุ",
    "3. ูู ุชุณุชูุชุน ุจุงูุชุญุฏูุงุช ุงูุฌุณุฏูุฉ ุฃู ุงูุฐูููุฉุ",
    "4. ุฃู ูู ูุฐู ุงูุจูุฆุงุช ุชูุถูู ุฃู ุชุชูุงุฌุฏ ูููุงุ",
    "5. ูุง ูุฏู ุงุณุชูุชุงุนู ุจุงูุนูู ุงูุฌูุงุนูุ",
    "6. ูู ุชูุถูู ุงููุบุงูุฑุฉ ุฃู ุงูุฑูุชููุ",
    "7. ููู ุชูุถู ุฃููุงุช ูุฑุงุบู ุนุงุฏุฉุ",
    "8. ูู ุชููู ุฅูู ุงูุชูููุฑ ุงูุงุณุชุฑุงุชูุฌู ุฃู ุงูุชูููุฐ ุงููุจุงุดุฑุ",
    "9. ููู ุชุชุนุงูู ูุน ุงููุฎุงุทุฑุฉุ",
    "10. ูุง ููุน ุงูุฌูุฏ ุงูุฐู ูุณุชูููู ุฃูุซุฑุ",
    "11. ูู ุชุญุจ ุงูููุงูุณุฉ ุฃู ุงูุชุนุงููุ",
    "12. ููู ุชุชูุงุนู ูุน ุงูุถุบุทุ",
    "13. ูู ุชุญุจ ุงูุฃูุนุงุจ ุงููุฑุฏูุฉ ุฃู ุงูุฌูุงุนูุฉุ",
    "14. ูุง ุงูุฐู ูุญูุฒู ููุงุณุชูุฑุงุฑุ",
    "15. ูู ุชูุถูู ุงูุฃูุดุทุฉ ุงูุฏุงุฎููุฉ ุฃู ุงูุฎุงุฑุฌูุฉุ",
    "16. ูุง ุดุนูุฑู ุชุฌุงู ุงูุงุฑุชูุงุนุงุช ุฃู ุงูุณุฑุนุฉุ",
    "17. ูู ุชุญุจ ุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุชุฌููุฒุงุชุ",
    "18. ูู ุฌุฑุจุช ุงูุชุฃูู ุฃู ุงูุฃูุดุทุฉ ุงูุฐูููุฉุ",
    "19. ููู ุชุตู ูุณุชูู ููุงูุชู ุงูุญุงููุ",
    "20. ุฃุฎุจุฑูุง ุดูุฆูุง ุนู ุนูุงูุชู ุจุงูุฑูุงุถุฉ ุฃู ูุฏูู ูููุง."
]

st.markdown("### โ๏ธ ุงูุฃุณุฆูุฉ:")
for q in questions:
    answer = st.text_input(q, key=q)
    user_answers += f"{q}\n{answer}\n\n"

# ุฒุฑ ุชูููุฏ ุงูุชูุตูุฉ
if st.button("๐ฏ ุงุนุฑุถ ุงูุชูุตูุฉ"):
    with st.spinner("ูุชู ุชุญููู ุฅุฌุงุจุงุชู..."):
        recommendation = generate_sport_recommendation(user_answers, language=lang_code)
        st.success("โจ ุชูุตูุชู ุงูุฑูุงุถูุฉ:")
        st.markdown(recommendation)

        # 1. ุฒุฑ ูุณุฎ ุงููุชูุฌุฉ
        if st.button("๐ ุงูุณุฎ ุงูุชูุตูุฉ"):
            pyperclip.copy(recommendation)
            st.toast("โ ุชู ูุณุฎ ุงูุชูุตูุฉ!")

        # 2. ุฒุฑ ุฑุงุจุท ุนุงู (placeholder ููุท)
        if st.button("๐ ูุดุงุฑูุฉ ุฑุงุจุท ุงููุชูุฌุฉ"):
            st.info("๐ง ุณูุชู ุชูุนูู ูุฐู ุงูููุฒุฉ ูุงุญููุง ุจุงุณุชุฎุฏุงู TinyURL ุฃู Firebase.")

        # 3. ุฒุฑ ุฏุนูุฉ ุตุฏูู
        if st.button("๐ฅ ุฏุนูุฉ ุตุฏูู ูุฌุงูุจ"):
            st.write("ุงูุณุฎ ุงูุฑุงุจุท ูุฃุฑุณูู ูุตุฏููู ููุฌุฑุจ ุงูุฃุณุฆูุฉ:")
            st.code("https://your-app-url.com")  # ุบููุฑู ูุงุญููุง ุจุงูุฑุงุจุท ุงูุญูููู

        # 4. ุฒุฑ ุชุญููู ุงูุชูุตูุฉ ุฅูู ุตูุฑุฉ
        if st.button("๐ผ๏ธ ุญููู ุงูุชูุตูุฉ ุฅูู ุตูุฑุฉ"):
            img = Image.new('RGB', (800, 600), color=(255, 255, 255))
            draw = ImageDraw.Draw(img)
            font = ImageFont.load_default()
            draw.text((10, 10), recommendation, fill=(0, 0, 0), font=font)
            buf = io.BytesIO()
            img.save(buf, format="PNG")
            st.image(buf.getvalue(), caption="ุชูุตูุชู ูุตูุฑุฉ", use_column_width=True)
